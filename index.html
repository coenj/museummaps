<!DOCTYPE html>
<html>

<head>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
</head>

<body>
  <script>
    //fetch("https://en.wikipedia.org//w/api.php?action=opensearch&format=json&origin=*&search=stack&limit=10")
    var searchpage = "Chabot_Museum"
    //var url = "https://wikimedia.org/api/rest_v1/metrics/pageviews/per-article/nl.wikipedia/all-access/all-agents/"+searchpage+"/monthly/2016010100/2016123100"
    //var url ="https://wikimedia.org/api/rest_v1/metrics/pageviews/per-article/en.wikipedia.org/all-access/all-agents/"+searchpage+"/monthly/20170501/20170531"
    var startDate = 20170601
    //var endDate = new Date('December 25, 1995 23:15:30');
    var endDate = new Date(Date.now())
    
    //console.log(endDate)
    var endDate = endDate.getFullYear() + doubleDigit(1+endDate.getMonth())+doubleDigit(endDate.getDate())

    var url = "https://wikimedia.org/api/rest_v1/metrics/pageviews/per-article/en.wikipedia.org/all-access/all-agents/" + searchpage + "/monthly/" + startDate + "/" + endDate
    console.log(endDate)

    // getArticleList();

    function doubleDigit(number) {
      return ("0" + number).slice(-2)
    }

    function getArticleList() {

      //var searchFor = "fiets"; //document.getElementById('intext').value;
      //var response = "";
      //console.log(searchFor);
      window.onload = function () {

        $.ajax({
          url: url,
          dataType: 'json',
          success: function (data) {
            //console.log(data);
            response = data;
          }
        }).done(function (response) {
          console.log(response);
          console.log(response.items[0].views); // <<< number of views of this page!
          console.log("loaded")
          document.getElementsByTagName("h2")[0].innerHTML = response.items[0].views


        })
      }
    }
//    "centralauthtoken": {
  //      "centralauthtoken": "47cd9cdb4ac7b62edfa438ae425a6f82309ef29"
   // }
  </script>

  <div class="container-fluid">
    <div class="row text-center">
      <h2>Cat Photo Finder</h2>
    </div>
    <div class="row text-center">
      <div class="col-xs-12 well message">
        The message will go here
      </div>
    </div>
    <div class="row text-center">
      <div class="col-xs-12">
        <button id="getMessage" class="btn btn-primary">
        Get Message
      </button>
      </div>
    </div>
  </div>
</body>

</html>